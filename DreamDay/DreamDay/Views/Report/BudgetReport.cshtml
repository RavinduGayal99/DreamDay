@model DreamDay.Models.Budget
@{
	Layout = null; var wedding = ViewBag.Wedding as DreamDay.Models.Wedding; var totalSpent = Model.BudgetCategories.SelectMany(c => c.Expenses).Sum(e => e.Amount);
}
<!DOCTYPE html>
<html>
<head>
	<title>Budget Report - @wedding.Title</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" />
	<style>
		body {
			padding: 20px;
		}
	</style>
</head>
<body>
	<h1>Budget Report</h1>
	<h2>@wedding.Title</h2>
	<p><strong>Client:</strong> @wedding.Couple.User.Name</p>
	<p><strong>Report Generated:</strong> @DateTime.Now.ToShortDateString()</p>
	<hr />
	<h3>Summary</h3>
	<p><strong>Total Wedding Budget:</strong> @wedding.Budget.ToString("C")</p>
	<p><strong>Total Spent:</strong> <span style="color:red;">@totalSpent.ToString("C")</span></p>
	<p><strong>Remaining:</strong> @(wedding.Budget - totalSpent).ToString("C")</p>
	<hr />
	<h3>Breakdown by Category</h3>
	@foreach (var category in Model.BudgetCategories)
	{
		var categorySpent = category.Expenses.Sum(e => e.Amount);
		<h4>@category.Name</h4>
		<p>Allocated: @category.AllocatedAmount.ToString("C") | Spent: @categorySpent.ToString("C")</p>
		<table class="table table-sm table-bordered">
			<thead><tr><th>Expense</th><th>Amount</th></tr></thead>
			<tbody>
				@foreach (var expense in category.Expenses)
				{
					<tr><td>@expense.Description</td><td>@expense.Amount.ToString("C")</td></tr>
				}
			</tbody>
		</table>
}
</body>
</html>