@model IEnumerable<DreamDay.Models.ProjectTask>
@{
	ViewData["Title"] = "Wedding Checklist";
	var categories = Model.Select(m => m.Category).Distinct().OrderBy(c => c.ToString());
	var weddingTitle = ViewBag.WeddingTitle ?? "My Checklist";
}

<h1>@weddingTitle</h1>
<p>
	<a asp-action="Create" asp-route-weddingId="@ViewBag.WeddingId" class="btn btn-primary">Add New Task</a>
</p>

<h1>@ViewData["Title"]</h1
><p><a asp-action="Create" class="btn btn-primary">Add New Task</a></p>
@foreach (var category in categories)
{
	<h3>@category.ToString()</h3>
	<ul class="list-group mb-4">
		@foreach (var ProjectTask in Model.Where(t => t.Category == category))
		{
			<li class="list-group-item d-flex justify-content-between align-items-center @(ProjectTask.IsCompleted ? "list-group-item-success" : "")">
				<div><strong class="@(ProjectTask.IsCompleted ? "text-decoration-line-through" : "")">@ProjectTask.Description</strong><br /><small>Due: @ProjectTask.DueDate.ToShortDateString()</small></div>
				<form asp-action="ToggleComplete" asp-route-id="@ProjectTask.Id" method="post"><button type="submit" class="btn @(ProjectTask.IsCompleted ? "btn-sm btn-warning" : "btn-sm btn-success")">@(ProjectTask.IsCompleted ? "Mark as Incomplete" : "Mark as Complete")</button></form>
			</li>
		}
	</ul>
}